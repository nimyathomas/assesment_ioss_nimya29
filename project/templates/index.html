{% extends "base.html" %}

{% block content %}
<div class="bg-white p-8 rounded-xl shadow-lg mb-8">
    <form method="POST" class="flex flex-col md:flex-row gap-4 items-center">
        <input type="url" name="long_url" placeholder="Paste your long URL here..." required
               class="flex-1 p-4 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-400 text-lg">
        <button type="submit"
                class="bg-blue-600 text-white px-6 py-4 rounded-lg font-semibold hover:bg-blue-700 transition">
            Shorten URL
        </button>
    </form>

    {% if short_url %}
    <div class="mt-6 p-4 bg-blue-50 rounded-lg flex flex-col md:flex-row items-center justify-between gap-4 shadow">
        <div>
            <strong class="text-blue-700">Short URL:</strong>
            <a href="{{ short_url }}" target="_blank" class="text-blue-600 underline break-all">{{ short_url }}</a>
        </div>
        <div class="flex gap-2">
            <button class="bg-green-500 text-white px-1 py-2 rounded-lg hover:bg-green-600 flex items-center"
                    onclick="navigator.clipboard.writeText('{{ short_url }}'); alert('Copied!')">
                <span class="material-icons mr-1">content_copy</span> Copy
            </button>
           <a href="https://api.whatsapp.com/send?text={{ short_url }}" target="_blank"
   class="bg-green-600 text-white px-2 py-2 rounded-lg hover:bg-green-700 flex items-center text-sm whitespace-normal max-w-[90px]">
    <span class="material-icons mr-1"></span> WhatsApp
</a>
            <a href="https://t.me/share/url?url={{ short_url }}" target="_blank"
               class="bg-blue-400 text-white px-3 py-2 rounded-lg hover:bg-blue-500 flex items-center">
                <span class="material-icons mr-1">send</span> Telegram
            </a>
            <a href="mailto:?subject=Check%20this%20URL&body={{ short_url }}"
               class="bg-gray-500 text-white px-3 py-2 rounded-lg hover:bg-gray-600 flex items-center">
                <span class="material-icons mr-1">email</span> Email
            </a>
        </div>
    </div>
    {% endif %}
</div>

<div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <div class="col-span-1 md:col-span-3 p-6 bg-white rounded-xl shadow-lg mb-4">
        <h2 class="font-bold text-lg mb-3 text-blue-700">Statistics</h2>
        <div class="flex gap-8 flex-wrap text-lg">
            <div class="flex items-center gap-2">
                <span class="material-icons text-blue-500">link</span>
                <span>Total URLs:</span> <span class="font-bold">{{ total_urls }}</span>
            </div>
            <div class="flex items-center gap-2">
                <span class="material-icons text-green-500">mouse</span>
                <span>Total Clicks:</span> <span class="font-bold">{{ total_clicks }}</span>
            </div>
        </div>
    </div>

    {% for url in recent_urls %}
    <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl transition flex flex-col justify-between">
        <div class="mb-3">
            <strong class="text-gray-700">Original:</strong>
            <span class="break-all">{{ url.long_url }}</span>
        </div>
        <div class="mb-3">
            <strong class="text-blue-700">Short:</strong>
            <a href="{{ request.host_url }}{{ url.short_code }}" target="_blank"
               class="text-blue-600 underline break-all">{{ request.host_url }}{{ url.short_code }}</a>
        </div>
        <div class="flex gap-2 mt-2 flex-wrap">
            <button class="bg-green-500 text-white px-3 py-2 rounded-lg hover:bg-green-600 flex items-center"
                    onclick="navigator.clipboard.writeText('{{ request.host_url }}{{ url.short_code }}'); alert('Copied!')">
                <span class="material-icons mr-1">content_copy</span> Copy
            </button>
            <button class="bg-blue-500 text-white px-3 py-2 rounded-lg hover:bg-blue-600 flex items-center"
                    onclick="window.open('/qr/{{ url.short_code }}', '_blank')">
                <span class="material-icons mr-1">qr_code</span> QR
            </button>
<!-- ...existing code... -->
<a href="https://api.whatsapp.com/send?text={{ request.host_url }}{{ url.short_code }}" target="_blank"
   class="bg-green-600 text-white px-2 py-2 rounded-lg hover:bg-green-700 flex items-center text-sm whitespace-normal max-w-[90px]">
    <span class="material-icons mr-1"></span> WhatsApp
</a>
<!-- ...existing code... -->
            <a href="https://t.me/share/url?url={{ request.host_url }}{{ url.short_code }}" 
               target="_blank"
               class="bg-blue-400 text-white px-3 py-2 rounded-lg hover:bg-blue-500 flex items-center">
                <span class="material-icons mr-1">send</span> Telegram
            </a>
            <a href="mailto:?subject=Check%20this%20short%20URL&body={{ request.host_url }}{{ url.short_code }}"
               class="bg-gray-500 text-white px-3 py-2 rounded-lg hover:bg-gray-600 flex items-center">
                <span class="material-icons mr-1">email</span> Email
            </a>
        </div>
        <div class="mt-3 text-gray-500 text-sm flex items-center gap-1">
            <span class="material-icons text-green-500">mouse</span> Clicks: {{ url.clicks }}
        </div>
    </div>
    {% endfor %}
</div>

<!-- Google Material Icons CDN -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

{% endblock %}